<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPC AI - v1.2</title>
    <meta name="description" content="GPC AI-powered workflow automation platform">
    <meta name="keywords" content="AI, workflow, automation, template">
    <meta name="author" content="GPC AI Team">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com?v=1.2"></script>
    
    <!-- Custom Styles -->
    <style>
        :root {
            --background: #000000;
            --foreground: #ffffff;
            --primary: #00ff00;
            --accent: #00ff00;
            --text-secondary: #9ca3af;
            --text-muted: #6b7280;
            --border: #333333;
        }

        * {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
        }

        html, body {
            max-width: 100vw;
            overflow-x: hidden;
            background: var(--background);
            color: var(--foreground);
            font-family: 'Inter', system-ui, sans-serif;
            font-weight: 600;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #000000;
        }

        ::-webkit-scrollbar-thumb {
            background: #333333;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #00ff00;
        }

        /* Selection */
        ::selection {
            background: rgba(0, 255, 0, 0.3);
            color: #ffffff;
        }

        /* Custom animations */
        @keyframes glow {
            0% { box-shadow: 0 0 20px rgba(0, 255, 0, 0.3); }
            100% { box-shadow: 0 0 30px rgba(0, 255, 0, 0.6); }
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes slideUp {
            0% { transform: translateY(10px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .animate-glow {
            animation: glow 2s ease-in-out infinite alternate;
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        .animate-slide-up {
            animation: slideUp 0.3s ease-out;
        }

        /* Custom utility classes */
        .bg-background { background-color: #000000 !important; }
        .bg-custom-dark-secondary { background-color: #000000 !important; }
        .bg-custom-dark-tertiary { background-color: #0a0a0a !important; }
        .bg-custom-dark { background-color: #0a0a0a !important; }
        .bg-accent { background-color: #00cc00; }
        .bg-primary-dark { background-color: #009900; }
        
        .text-text { color: #ffffff; }
        .text-text-secondary { color: #9ca3af; }
        .text-text-muted { color: #6b7280; }
        .text-accent { color: #00cc00; }
        
        .border-border { border-color: #333333; }
        .border-gray-700 { border-color: #00ff00; }
        
        .shadow-none { box-shadow: 0 0 20px rgba(0, 255, 0, 0.3); }
        .shadow-none-hover { box-shadow: 0 0 30px rgba(0, 255, 0, 0.5); }
        
        .rounded-xl { border-radius: 1rem; }
        .rounded-2xl { border-radius: 1.5rem; }
        .rounded-3xl { border-radius: 2rem; }

        /* Responsive design */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 80px;
                height: calc(100vh - 80px);
                z-index: 50;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .sidebar-toggle {
                display: block;
            }
        }

        .sidebar-toggle {
            display: none;
        }
    </style>
</head>
<body class="antialiased">
    <!-- Header -->
    <header class="h-20 bg-custom-dark-secondary border-b border-border flex items-center justify-center px-6 relative">
        <!-- Mobile menu toggle -->
        <button class="sidebar-toggle absolute left-4 top-1/2 transform -translate-y-1/2 text-text-secondary hover:text-text" onclick="toggleLeftSidebar()">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>
        
        <div class="flex items-center gap-4">
            <!-- Logo -->
            <img src="assets/transparent-logo.png" alt="GPC AI Logo" class="w-16 h-16 rounded-2xl object-cover">            
            <!-- Brand Name -->
            <h1 class="text-2xl font-bold text-text">
                GPC AI
            </h1>
        </div>

        <!-- Right sidebar toggle for mobile -->
        <button class="sidebar-toggle absolute right-4 top-1/2 transform -translate-y-1/2 text-text-secondary hover:text-text" onclick="toggleRightSidebar()">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
            </svg>
        </button>
    </header>

    <!-- Main Content -->
    <div class="flex h-[calc(100vh-80px)]">
        <!-- Left Sidebar - Workflows -->
        <aside id="leftSidebar" class="sidebar w-80 bg-custom-dark-secondary border-r border-border p-6 overflow-y-auto">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-text mb-2">Workflows</h2>
                            <p class="text-text-secondary text-sm">Select a workflow to get started</p>
                        </div>
                
            <div class="space-y-3" id="workflowsList">
                        <!-- Workflows will be populated by JavaScript -->
                    </div>
                    
            <button class="w-full mt-6 p-3 bg-accent text-black font-semibold rounded-xl hover:bg-primary-dark transition-colors duration-200 shadow-none hover:shadow-none-hover">
                        + New Workflow
                    </button>
        </aside>
        
        <!-- Main Chat Area -->
        <div class="flex-1 flex flex-col">
            <div class="flex-1 flex flex-col bg-custom-dark">
                <!-- Chat Header -->
            <div class="flex items-center justify-between mb-4">
                                <div>
                    <h2 class="text-xl font-bold text-text">AI Assistant</h2>
                    <p class="text-text-secondary text-sm">Ask me anything about workflows, automation, or get help with your tasks</p>
                </div>
                <div class="flex items-center space-x-3">
                    <select id="modelSelector" class="bg-custom-dark border border-border text-text rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-gray-700">
                                        <option value="gpt-4">GPT-4</option>
                                        <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                        <option value="claude">Claude 3 Sonnet</option>
                                    </select>
                    <div class="flex items-center space-x-2 text-text-secondary text-sm">
                        <span>Knowledge Base: Always Active</span>
                                </div>
                                </div>
                                    </div>
                <div class="p-6 border-b border-border">
                    <h2 class="text-xl font-bold text-text">AI Assistant</h2>
                    <p class="text-text-secondary text-sm">Ask me anything about workflows, automation, or get help with your tasks</p>
                                </div>

                <!-- Messages -->
                <div class="flex-1 overflow-y-auto p-6 space-y-4" id="chatMessages">
                    <!-- Messages will be populated by JavaScript -->
                        </div>

                <!-- Input Area -->
                <div class="p-6 border-t border-border">
                    <div class="flex gap-3">
                        <div class="flex-1 relative">
                            <textarea
                                id="chatInput"
                                placeholder="Type your message here..."
                                class="w-full p-4 pr-20 bg-custom-dark-secondary border border-border rounded-xl text-text placeholder-text-muted resize-none focus:outline-none focus:border-gray-700 focus:ring-1 focus:ring-gray-600 transition-all duration-200"
                                rows="3"
                                onkeypress="handleKeyPress(event)"
                            ></textarea>
                            
                            <!-- Image upload button -->
                            <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                            <button
                                onclick="document.getElementById('imageInput').click()"
                                class="absolute right-12 bottom-3 p-2 bg-gray-600 text-white rounded-lg hover:bg-gray-500 transition-colors duration-200"
                                title="Upload Image"
                            >
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                </svg>
                            </button>
                            
                            <!-- Send button -->
                            <button
                                onclick="sendMessage()"
                                class="absolute right-3 bottom-3 p-2 bg-accent text-black rounded-lg hover:bg-primary-dark transition-colors duration-200"
                            >
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- How to Use Section -->
            <div class="border-t border-border bg-custom-dark-secondary">
                <div class="p-6">
                    <button onclick="toggleHowToUse()" class="flex items-center justify-between w-full text-left">
                        <h3 class="text-lg font-semibold text-text">How to Use</h3>
                        <svg id="howToUseIcon" class="w-5 h-5 text-text-secondary transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>

                    <div id="howToUseContent" class="mt-4 space-y-4 animate-fade-in hidden">
                        <p class="text-text-secondary text-sm">
                            Get started with GPC AI in three simple steps:
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="p-4 bg-custom-dark rounded-xl border border-border hover:border-gray-700 transition-all duration-200">
                                <div class="text-3xl mb-3">📋</div>
                                <h4 class="font-semibold text-text mb-2">Select a Workflow</h4>
                                <p class="text-text-secondary text-sm">Choose from the available workflows in the left sidebar or create a new one.</p>
                            </div>
                            <div class="p-4 bg-custom-dark rounded-xl border border-border hover:border-gray-700 transition-all duration-200">
                                <div class="text-3xl mb-3">💬</div>
                                <h4 class="font-semibold text-text mb-2">Chat with AI</h4>
                                <p class="text-text-secondary text-sm">Describe what you want to accomplish in the chat area. Be specific about your goals.</p>
                        </div>
                            <div class="p-4 bg-custom-dark rounded-xl border border-border hover:border-gray-700 transition-all duration-200">
                                <div class="text-3xl mb-3">✅</div>
                                <h4 class="font-semibold text-text mb-2">Review & Execute</h4>
                                <p class="text-text-secondary text-sm">The AI will help you set up and execute your workflow. Check the history for results.</p>
                            </div>
                        </div>

                        <div class="mt-6 p-4 bg-accent/10 border border-gray-700/20 rounded-xl">
                            <h4 class="font-semibold text-accent mb-2">💡 Pro Tips</h4>
                            <ul class="text-text-secondary text-sm space-y-1">
                                <li>• Be specific about your requirements for better results</li>
                                <li>• Use the workflow templates as starting points</li>
                                <li>• Check the history to track your progress</li>
                                <li>• The AI learns from your usage patterns</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - History -->
        <aside id="rightSidebar" class="sidebar w-80 bg-custom-dark-secondary border-l border-border p-6 overflow-y-auto">
            <div class="mb-6">
                <h2 class="text-xl font-bold text-text mb-2">History</h2>
                <p class="text-text-secondary text-sm">Recent workflow executions</p>
                    </div>
                    
            <div class="space-y-3" id="historyList">
                <!-- History items will be populated by JavaScript -->
                        </div>

            <button class="w-full mt-6 p-3 border border-border text-text-secondary font-medium rounded-xl hover:border-gray-700 hover:text-text transition-colors duration-200">
                View All History
                                </button>
        </aside>
        </div>

    <!-- API Client -->
    <script src="js/api-client.js"></script>
    
    <!-- JavaScript -->
    <script>
        // Sample data
        const workflows = [
            {
                id: '1',
                name: 'Content Generation',
                description: 'Automated content creation workflow',
                status: 'active'
            },
            {
                id: '2',
                name: 'Data Processing',
                description: 'ETL pipeline for data analysis',
                status: 'active'
            },
            {
                id: '3',
                name: 'Email Automation',
                description: 'Customer communication workflow',
                status: 'draft'
            },
            {
                id: '4',
                name: 'Report Generation',
                description: 'Weekly analytics reports',
                status: 'inactive'
            }
        ];

        const history = [
            {
                id: '1',
                title: 'Content generation for Q4 campaign',
                timestamp: '2 hours ago',
                workflow: 'Content Generation',
                status: 'completed'
            },
            {
                id: '2',
                title: 'Data processing for user analytics',
                timestamp: '1 day ago',
                workflow: 'Data Processing',
                status: 'completed'
            },
            {
                id: '3',
                title: 'Email automation setup',
                timestamp: '3 days ago',
                workflow: 'Email Automation',
                status: 'failed'
            },
            {
                id: '4',
                title: 'Weekly report generation',
                timestamp: '1 week ago',
                workflow: 'Report Generation',
                status: 'completed'
            }
        ];

        let messages = [
            {
                id: '1',
                type: 'ai',
                content: 'Hello! I have access to your knowledge base with 69 documents about TikTok strategies, dropshipping, marketing, and more. Ask me anything or upload screenshots of your analytics, dashboards, or performance data for instant analysis!',
                timestamp: new Date()
            }
        ];

        let selectedWorkflow = '1';
        let currentImage = null;

        // Handle image upload
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentImage = e.target.result;
                    // Show preview in chat
                    const newMessage = {
                        id: Date.now().toString(),
                        type: 'user',
                        content: `📷 Image uploaded: ${file.name}`,
                        timestamp: new Date()
                    };
                    messages.push(newMessage);
                    renderMessages();
                };
                reader.readAsDataURL(file);
            }
        }
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            renderWorkflows();
            renderHistory();
            renderMessages();
        });

        // Render workflows
        function renderWorkflows() {
            const workflowsList = document.getElementById('workflowsList');
            workflowsList.innerHTML = workflows.map(workflow => `
                <div
                    class="p-4 rounded-xl border cursor-pointer transition-all duration-200 hover:shadow-none-hover ${
                        selectedWorkflow === workflow.id
                            ? 'border-gray-700 bg-custom-dark-tertiary shadow-none'
                            : 'border-border bg-custom-dark hover:border-gray-700'
                    }"
                    onclick="selectWorkflow('${workflow.id}')"
                >
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="font-semibold text-text">${workflow.name}</h3>
                        <span class="text-xs font-medium px-2 py-1 rounded-full bg-custom-dark ${getStatusColor(workflow.status)}">
                            ${workflow.status}
                        </span>
                    </div>
                    <p class="text-text-secondary text-sm">${workflow.description}</p>
                </div>
            `).join('');
        }

        // Render history
        function renderHistory() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = history.map(item => `
                <div class="p-4 rounded-xl border border-border bg-custom-dark hover:border-gray-700 transition-all duration-200 cursor-pointer">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="font-semibold text-text text-sm leading-tight">${item.title}</h3>
                        <span class="text-xs font-medium px-2 py-1 rounded-full bg-custom-dark ${getStatusColor(item.status)}">
                            ${getStatusIcon(item.status)}
                        </span>
                    </div>
                    <div class="text-text-secondary text-xs space-y-1">
                        <p>${item.workflow}</p>
                        <p>${item.timestamp}</p>
                    </div>
                </div>
            `).join('');
        }

        // Render messages with proper formatting
        function renderMessages() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = messages.map(message => `
                <div class="flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}">
                    <div class="max-w-[70%] p-4 rounded-2xl ${
                        message.type === 'user'
                            ? 'bg-accent text-black'
                            : 'bg-custom-dark-secondary text-text border border-border'
                    }">
                        <div class="text-sm leading-relaxed">${formatAIResponse(message.content)}</div>
                        <p class="text-xs mt-2 ${
                            message.type === 'user' ? 'text-black/70' : 'text-text-muted'
                        }">
                            ${message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                        </p>
                    </div>
                </div>
            `).join('');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Format AI response with proper HTML
        function formatAIResponse(content) {
            return content
                .replace(/\*\*(.*?)\*\*/g, '<strong class="text-accent">$1</strong>')
                .replace(/^### (.*$)/gm, '<h3 class="text-lg font-semibold text-accent mt-4 mb-2">$1</h3>')
                .replace(/^## (.*$)/gm, '<h2 class="text-xl font-bold text-accent mt-4 mb-3">$1</h2>')
                .replace(/^# (.*$)/gm, '<h1 class="text-2xl font-bold text-accent mt-4 mb-4">$1</h1>')
                .replace(/^- (.*$)/gm, '<li class="ml-4">$1</li>')
                .replace(/(<li.*<\/li>)/s, '<ul class="list-disc ml-6 space-y-1">$1</ul>')
                .replace(/\n/g, '<br>');
        }

        // Helper functions
        function getStatusColor(status) {
            switch (status) {
                case 'active':
                case 'completed':
                    return 'text-accent';
                case 'inactive':
                case 'draft':
                    return 'text-text-secondary';
                case 'failed':
                    return 'text-red-400';
                case 'running':
                    return 'text-blue-400';
                default:
                    return 'text-text-secondary';
            }
        }

        function getStatusIcon(status) {
            switch (status) {
                case 'completed':
                    return '✓';
                case 'failed':
                    return '✗';
                case 'running':
                    return '⟳';
                default:
                    return '•';
            }
        }

        // Workflow selection
        function selectWorkflow(id) {
            selectedWorkflow = id;
            renderWorkflows();
        }

        // Show thinking indicator
        function showThinkingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.id = 'thinking';
            thinkingDiv.className = 'flex justify-start';
            thinkingDiv.innerHTML = `
                <div class="max-w-[70%] p-4 rounded-2xl bg-custom-dark-secondary text-text border border-border">
                    <div class="flex items-center space-x-2">
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-accent rounded-full animate-bounce"></div>
                            <div class="w-2 h-2 bg-accent rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                            <div class="w-2 h-2 bg-accent rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        </div>
                        <span class="text-text-secondary text-sm">AI is thinking...</span>
                    </div>
                </div>
            `;
            chatMessages.appendChild(thinkingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Hide thinking indicator
        function hideThinkingIndicator() {
            const thinking = document.getElementById('thinking');
            if (thinking) thinking.remove();
        }

        // Chat functionality with real AI
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const content = input.value.trim();
            
            if (!content && !currentImage) return;

            const newMessage = {
                id: Date.now().toString(),
                type: 'user',
                content: content || '📷 Analyzing image...',
                timestamp: new Date()
            };

            messages.push(newMessage);
            input.value = '';
            renderMessages();

            // Show thinking indicator
            showThinkingIndicator();

            try {
                // Get AI response with real API calls
                const response = await getAIResponse(content, currentImage);
                
                hideThinkingIndicator();
                
                const aiResponse = {
                    id: (Date.now() + 1).toString(),
                    type: 'ai',
                    content: response,
                    timestamp: new Date()
                };
                messages.push(aiResponse);
                renderMessages();
                
                // Clear the image after processing
                currentImage = null;
                
            } catch (error) {
                hideThinkingIndicator();
                const errorResponse = {
                    id: (Date.now() + 1).toString(),
                    type: 'ai',
                    content: 'Sorry, I encountered an error: ' + error.message + '. Please try again.',
                    timestamp: new Date()
                };
                messages.push(errorResponse);
                renderMessages();
            }
        }

        // Real AI response function
        async function getAIResponse(prompt, imageData = null) {
            try {
                // Get selected model - use GPT-4 Vision for images
                const selectedModel = imageData ? 'gpt-4-vision-preview' : document.getElementById('modelSelector').value;
                
                // Build messages array
                const messages = [{
                    role: 'system',
                    content: `You are a mentor-style AI assistant speaking and thinking like Chris. You serve as the always-on extension of Chris's mind — clear, direct, and grounded in real data.

Your primary source of truth is the **vector store**, which is continuously updated from a Google Sheet. When answering questions, follow this hierarchy of sourcing:

1. **First**: Pull structured data, facts, context, and insights from the vector store.
2. **Second**: If the information was authored or input by Chris directly, treat it as **top authority** — override all other data when needed.
3. **Third**: Only use external reasoning from AI tools (OpenAI, Claude) to fill logical gaps, optimize clarity, or improve delivery. Never contradict or dilute what Chris has provided.
4. **If information is missing or unclear**, do not guess. Instead, **redirect users back to Chris** via his preferred feedback loop (e.g., link to Typeform or prompt a clarification form).

---

## 🧠 BEHAVIOR & PERSONALITY

- You speak **exactly like Chris** — mentor-like, strategic, friendly but blunt when needed.
- Use the **tone, metaphors, frameworks, and logic** Chris uses.
- Never present responses as AI-generated. Every insight should appear to originate from Chris himself.
- You maintain **long-term memory**: Remember what the user has asked in the past and refine your future responses to better match their patterns, preferences, and progress.
- You are **outcome-oriented**. Always guide the user toward clarity, action, and results — not just knowledge.

---

## 🧭 RESPONSE STRUCTURE (EVERY TIME)

Your answers must always follow this format unless explicitly instructed otherwise:

1. **Step-by-Step Instructions**  
   - **COMPREHENSIVE and DETAILED** — every step must be fully explained with specific actions, tools, platforms, and exact processes
   - **Answer ALL questions** — if someone asks "how to go viral," don't just give 3 steps, give them the complete roadmap with every detail they need
   - **Include specific examples** — real numbers, exact settings, platform names, button locations
   - **Cover edge cases** — what to do when things go wrong, alternative approaches, troubleshooting
   - **Be exhaustive** — leave no stone unturned, anticipate follow-up questions and answer them proactively
2. **Explanation (Theory/Why)**  
   - Why this works, how it connects to strategy, and any deeper insight the user should internalize.
3. **Optional Extras (if relevant)**  
   - Bonus tip, warning, shortcut, framework, or resource — only if helpful or accelerative.
4. **Follow-Up Questions (Next Prompts)**  
   - **ALWAYS end with 5-10 tailored follow-up questions** that drive continued learning and immediate action
   - **Mix learning + action**: Some questions should deepen knowledge, others should push toward execution
   - **Progressive difficulty**: Start with beginner-friendly questions, escalate to advanced strategies
   - **Specific and actionable**: Each question should feel like a natural next step the user wants to take
   - **Create momentum**: Questions should make users think "I need to know this next" or "I should do this now"
   - **Address common blockers**: Include questions that solve typical roadblocks or hesitations

**CRITICAL**: The step-by-step section should be so detailed that the user can execute without asking follow-up questions. Think of it as a complete tutorial, not a summary.

---

## 📸 IMAGE ANALYSIS SPECIAL INSTRUCTIONS

When analyzing screenshots or images:
- **Identify the platform/context** (TikTok analytics, Shopify dashboard, Facebook ads, etc.)
- **Extract specific metrics and numbers** from the image
- **Compare against industry benchmarks** and best practices
- **Identify problems, opportunities, and trends** visible in the data
- **Provide specific, actionable recommendations** based on what you see
- **Explain the "why" behind each recommendation** using Chris's strategic thinking

---

## ⚠️ SPECIAL CONSTRAINTS

- **Never cite external sources** (e.g., "according to X article").
- **Do not sound like an AI**. Never use phrases like "As an AI…" or "Based on my data…"
- Never hallucinate numbers or names unless they exist in the vector store or were written by Chris.
- **Do not correct Chris** — refine or enhance the logic behind his insights, but always frame it as if he evolved the idea himself.
- If information is inconsistent, **blend the data into the most useful and elegant synthesis**, then present it in Chris's voice.

---

## 🧩 MEMORY + CONTEXT AWARENESS

You must:
- Track each user's conversation history and recall it to personalize future outputs.
- Ask clarifying questions when goals are unclear or context is missing.
- Be proactive in suggesting how to improve results, fix problems, or avoid common traps.

---

## 🛑 WHEN TO DEFER

If the user asks something that:
- **Cannot be answered** with the current data, and
- **Isn't appropriate for AI reasoning alone**,

Respond with:
> "Chris will need to handle this one directly. [Insert Typeform or feedback link] so he can answer with full context."

---

## 🔄 OPTIONAL SELF-IMPROVEMENT LOOP

If the user requests improved output, or if a prompt generates weak results:
- Re-run the prompt internally through Claude and OpenAI to optimize tone, logic, and clarity — then present the **refined Chris-style version**.
- Use iterative self-scoring if allowed: "Here's the upgraded version — scored and improved based on clarity and usefulness."

---

## 🌐 API INTEGRATION AWARENESS

You are allowed to:
- Send reasoning prompts to Claude/OpenAI in the background to clarify or expand on weak or ambiguous inputs.
- Never show raw API responses — always rewrite in Chris's tone and format, filtered through the logic above.

---

## 🧬 FINAL PRINCIPLES

- Be **hyper-relevant** to the user's situation.
- Focus on **leverage, not just answers**.
- Teach in a way that makes the user smarter and more independent over time.
- **DEPTH OVER BREVITY** — provide exhaustive, detailed guidance that leaves nothing to chance.
- **ANTICIPATE EVERYTHING** — think through every possible scenario, question, and edge case the user might encounter.
- **DRIVE CONTINUED ENGAGEMENT** — every response should make the user want to ask the next question or take the next action.

---

### ✅ Ready to go. Act as the AI Extension of Chris — Clear, Strategic, Actionable.`
                }];

                // Add user message with image if present
                const userMessage = {
                    role: 'user',
                    content: []
                };

                // Add text content
                if (prompt) {
                    userMessage.content.push({
                        type: 'text',
                        text: prompt
                    });
                }

                // Add image if present
                if (imageData) {
                    userMessage.content.push({
                        type: 'image_url',
                        image_url: {
                            url: imageData,
                            detail: 'high'
                        }
                    });
                }

                messages.push(userMessage);

                // Use the selected AI model for better, more organized responses
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer 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'
                    },
                    body: JSON.stringify({
                        model: selectedModel,
                        messages: messages,
                        max_tokens: 2000,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    throw new Error('OpenAI API error: ' + response.status);
                }
                
                const data = await response.json();
                return data.choices[0].message.content;
                
            } catch (error) {
                console.error('AI response error:', error);
                throw error;
            }
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        // How to use toggle
        function toggleHowToUse() {
            const content = document.getElementById('howToUseContent');
            const icon = document.getElementById('howToUseIcon');
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        // Mobile sidebar toggles
        function toggleLeftSidebar() {
            const sidebar = document.getElementById('leftSidebar');
            sidebar.classList.toggle('open');
        }

        function toggleRightSidebar() {
            const sidebar = document.getElementById('rightSidebar');
            sidebar.classList.toggle('open');
        }

        // Close sidebars when clicking outside on mobile
        document.addEventListener('click', function(e) {
            if (window.innerWidth <= 768) {
                const leftSidebar = document.getElementById('leftSidebar');
                const rightSidebar = document.getElementById('rightSidebar');
                
                if (!leftSidebar.contains(e.target) && !e.target.closest('.sidebar-toggle')) {
                    leftSidebar.classList.remove('open');
                }
                
                if (!rightSidebar.contains(e.target) && !e.target.closest('.sidebar-toggle')) {
                    rightSidebar.classList.remove('open');
                }
            }
        });
    </script>
</body>
</html>
